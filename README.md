# 2ch Posts Pictures Roulette
Скрипт рулетки по типу B-LEVEL COUNTRY, продвинутая версия.
Исправлены многие недостатки предыдущего простого скрипта, внесена инкапсуляция от имиджборды и самого файла рулетки, скрипт открыт к изменениям.

## Инструкция по использованию для людей с iq 60:
1. Скачиваем на телефон с android приложение: [Сервер для PHP](https://play.google.com/store/apps/details?id=com.esminis.server.php&hl=ru)
2. Заходим в него, жмем кнопку "ЗАПУСТИТЬ СЕРВЕР"
3. В корне файловой системы телефона появится папка "www", заходим туда, потом в "public".
4. Скачиваем архив: https://github.com/f77/2ch_posts_pictures_roulette/archive/master.zip
5. Распаковываем его в папку /www/public. Таким образом, должна появится папка /www/public/2ch_posts_pictures_roulette.
6. В этой папке находится находится файл config.ini, там настройки. Указываем там номер треда.
7. Заходим в браузере телефона по адресу "http://0.0.0.0:8080/2ch_posts_pictures_roulette". Там 2 кнопки: "Загрузить новые посты" и "Заполнить изображение". Используй их.
8. В папке IMAGES_RESULT появится итоговая заполненая пикча. 
9. В идеале еще отредактируй файл /www/config/php.ini и напиши туда "memory_limit = 512M", чтобы скрипту было доступно больше памяти и он не падал на больших картинках.


## Требования:
- Вебсервер с php7, php7-curl.
Можно запускать даже на более-менее нормальной мобиле.
Например, отлично работает на приложении веб-сервера для ведра: [Сервер для PHP](https://play.google.com/store/apps/details?id=com.esminis.server.php&hl=ru).
- Рекомендуется в php.ini увеличить memory_limit до 512-1024M, иначе на больших пикчах скрипт может падать.

## Использование:
1. Задаем настройки (борда, номер треда, тип рулетки) в файле config.ini.
2. Переходим в папку со скриптом из браузера, там будет страница с двумя кнопками: **Загрузить новые посты** и **Заполнить изображение**.
3. Чтобы скачать новые пикчи, жмем первую ссылку. Скрипт скачает те посты с треда, что попадают под комбинации из шаблона. Если комбо уже выбито, оно не заменяется на другое. Допустим, если есть два трипла из одинаковых цифр, то второй считается даблом, а не заменит первый.
4. Чтобы из этой кучи пикч получить итоговый файл, жмем вторую ссылку. Результат будет сохранен в папке IMAGES_RESULT. Эта функция жрет немало оперативной памяти. Смотреть про memory_limit в начале.

Заполнять можно спокойно на протяжении нескольких тредов. Ибо лоадер будет скачивать только новые комбинации, которых еще нет в папке IMAGES_TEMP.
Таким образом, уже выпавшим комбинациям ничего не грозит.

Если необходимо исключить некоторые посты из скачивания (например, если пост с результатом заполнения выбил какое-то комбо, или еще по какой причине), в настройках можно исключать посты по номерам.

Чтобы начать заново, нужно лишь очистить папку IMAGES_TEMP.

## Магнит комбинаций
Если задать в настройках параметр MAGNET_RADIUS больше нуля, то становится не обязательным выбивать точную комбинацию.
Допустим, если MAGNET_RADIUS=1 и надо выбить трипл 111.
То посты, оканчивающиеся на 110 и 112 будут считаться триплом 111.
Но если потом появится настоящий трипл 111, то старое изображение будет заменено на него.
Это позволяет собрать рулетку за гораздо меньшее время.
Не рекомендуется задавать слишком большое значение радиуса магнита.

## Создание других шаблонов:
Вы можете создать собственный шаблон для заполнения скриптом.
Ознакомьтесь с содержимым папки TEMPLATES.
Создайте файл шаблона и json-файл конфига с указанием местоположения ячеек.
